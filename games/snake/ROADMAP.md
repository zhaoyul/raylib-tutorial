# ğŸ Snake æ¸¸æˆå¼€å‘è·¯çº¿å›¾ / Development Roadmap

æœ¬æ–‡æ¡£è¯¦ç»†æè¿°äº† Snake æ¸¸æˆçš„æ¸è¿›å¼å¼€å‘è®¡åˆ’ï¼Œæ¯ä¸ªç‰ˆæœ¬éƒ½å»ºç«‹åœ¨å‰ä¸€ä¸ªç‰ˆæœ¬çš„åŸºç¡€ä¸Šï¼Œé€æ­¥å¼•å…¥æ–°çš„æ¸¸æˆå¼€å‘æ¦‚å¿µå’Œ C++ æŠ€æœ¯ã€‚

---

## ğŸ“Š ç‰ˆæœ¬æ€»è§ˆ

```
v0-base â”€â”€â–º v1-items â”€â”€â–º v2-fx â”€â”€â–º v3-audio â”€â”€â–º v4-multi
 (åŸºç¡€)      (é“å…·)      (ç‰¹æ•ˆ)      (éŸ³æ•ˆ)       (å¤šäºº)
   â­          â­â­          â­â­          â­â­â­         â­â­â­â­
```

---

## ğŸ¯ v0-base: ç»å…¸è´ªåƒè›‡

### ç›®æ ‡
å®ç°ä¸€ä¸ªåŠŸèƒ½å®Œæ•´çš„ç»å…¸è´ªåƒè›‡æ¸¸æˆï¼Œä½œä¸ºåç»­æ‰©å±•çš„åŸºç¡€ã€‚

### åŠŸèƒ½æ¸…å•
- [x] è›‡çš„ç§»åŠ¨å’Œæˆé•¿
- [x] é£Ÿç‰©éšæœºç”Ÿæˆï¼ˆä¸ä¸è›‡é‡å ï¼‰
- [x] å¢™å£ç¢°æ’æ£€æµ‹
- [x] è‡ªèº«ç¢°æ’æ£€æµ‹
- [x] åˆ†æ•°ç³»ç»Ÿ
- [x] é€Ÿåº¦éšåˆ†æ•°é€’å¢
- [x] æ¸¸æˆçŠ¶æ€ï¼šèœå•ã€æ¸¸æˆä¸­ã€ç»“æŸ
- [x] æ–¹å‘é”®å’Œ WASD åŒæ§åˆ¶æ–¹æ¡ˆ

### æ ¸å¿ƒä»£ç ç»“æ„
```
v0-base/
â”œâ”€â”€ main.cpp          # å•æ–‡ä»¶å®ç°
â””â”€â”€ README.md         # ç‰ˆæœ¬è¯´æ˜
```

### å…³é”®æŠ€æœ¯ç‚¹
| æ¦‚å¿µ                   | åº”ç”¨                                          |
|------------------------|-----------------------------------------------|
| `std::deque<Position>` | è›‡èº«æ•°æ®ç»“æ„ï¼Œå¤´éƒ¨æ’å…¥ã€å°¾éƒ¨åˆ é™¤éƒ½æ˜¯ O(1)     |
| `GetFrameTime()`       | å¸§ç‡æ— å…³çš„æ¸¸æˆé€Ÿåº¦æ§åˆ¶                        |
| çŠ¶æ€æœºæšä¸¾             | `enum GameState { MENU, PLAYING, GAME_OVER }` |
| Lambda å‡½æ•°            | å±…ä¸­ç»˜åˆ¶æ–‡å­—çš„è¾…åŠ©å‡½æ•°                        |

### å­¦ä¹ èµ„æº
- [std::deque æ–‡æ¡£](https://en.cppreference.com/w/cpp/container/deque)
- [Raylib åŸºç¡€ç¤ºä¾‹](https://www.raylib.com/examples.html)

---

## ğŸ v1-items: é“å…·ä¸éšœç¢ç³»ç»Ÿ

### ç›®æ ‡
å¼•å…¥é“å…·ç³»ç»Ÿå’Œéšœç¢ç‰©ï¼Œå­¦ä¹ é¢å‘å¯¹è±¡ç¼–ç¨‹çš„æ ¸å¿ƒæ¦‚å¿µã€‚

### æ–°å¢åŠŸèƒ½
#### é£Ÿç‰©å¤šæ ·åŒ–
| é£Ÿç‰©ç±»å‹ | æ•ˆæœ          | å‡ºç°æ¦‚ç‡ | æŒç»­æ—¶é—´ |
|----------|---------------|----------|----------|
| ğŸ æ™®é€š  | +10åˆ†ï¼Œé•¿åº¦+1 | 70%      | -        |
| ğŸŒŸ é‡‘è‰²  | +50åˆ†ï¼Œé•¿åº¦+3 | 10%      | 5ç§’      |
| âš¡ é—ªç”µ  | é€Ÿåº¦ç¿»å€10ç§’  | 12%      | -        |
| ğŸŒ èœ—ç‰›  | é€Ÿåº¦å‡åŠ10ç§’  | 8%       | -        |

#### éšœç¢ç‰©ç³»ç»Ÿ
- æ¯å…³éšæœºç”Ÿæˆ 3-10 ä¸ªéšœç¢ç‰©
- éšœç¢ç‰©ä½ç½®ä¸ä¸è›‡å’Œé£Ÿç‰©é‡å 
- è›‡æ’åˆ°éšœç¢ç‰©æŸå¤±ä¸€æ¡ç”Ÿå‘½ï¼ˆå…±3æ¡ï¼‰

#### ç”Ÿå‘½ç³»ç»Ÿ
- åˆå§‹3æ¡ç”Ÿå‘½
- æ’å¢™/æ’éšœç¢ -1 ç”Ÿå‘½
- æ’è‡ªèº«ç›´æ¥æ¸¸æˆç»“æŸ
- æ¯500åˆ†å¥–åŠ± +1 ç”Ÿå‘½

### ä»£ç ç»“æ„å˜åŒ–
```
v1-items/
â”œâ”€â”€ main.cpp
â”œâ”€â”€ item.h / item.cpp       # é“å…·åŸºç±»å’Œæ´¾ç”Ÿç±»
â”œâ”€â”€ obstacle.h / obstacle.cpp # éšœç¢ç‰©
â”œâ”€â”€ game.h / game.cpp       # æ¸¸æˆé€»è¾‘å°è£…
â””â”€â”€ README.md
```

### æ ¸å¿ƒæŠ€æœ¯ï¼šå¤šæ€
```cpp
class Item {
public:
    virtual void applyEffect(Snake& snake, Game& game) = 0;
    virtual Color getColor() const = 0;
    virtual int getScore() const = 0;
    virtual ~Item() = default;
};

class GoldenFood : public Item {
public:
    void applyEffect(Snake& snake, Game& game) override {
        snake.grow(3);
        game.addScore(50);
    }
    Color getColor() const override { return GOLD; }
    int getScore() const override { return 50; }
};
```

### è®¾è®¡æŒ‘æˆ˜
1. **å¦‚ä½•å†³å®šç”Ÿæˆå“ªç§é£Ÿç‰©ï¼Ÿ** - ä½¿ç”¨åŠ æƒéšæœºç®—æ³•
2. **é™æ—¶é£Ÿç‰©å¦‚ä½•æ¶ˆå¤±ï¼Ÿ** - ç»™é£Ÿç‰©æ·»åŠ  `lifetime` å­—æ®µ
3. **å¦‚ä½•ç®¡ç†é“å…·æ•ˆæœæŒç»­æ—¶é—´ï¼Ÿ** - ä½¿ç”¨ `TimedEffect` ç»“æ„ä½“

---

## âœ¨ v2-fx: ç²’å­ç³»ç»Ÿä¸åŠ¨ç”»

### ç›®æ ‡
æ·»åŠ è§†è§‰ç‰¹æ•ˆï¼Œè®©æ¸¸æˆæ›´åŠ ç”ŸåŠ¨ï¼Œå­¦ä¹ å®æ—¶å›¾å½¢ç¼–ç¨‹åŸºç¡€ã€‚

### æ–°å¢åŠŸèƒ½

#### ç²’å­ç³»ç»Ÿ
| æ•ˆæœ | è§¦å‘æ¡ä»¶       | ç²’å­æ•°é‡ | è¯´æ˜                   |
|------|----------------|----------|------------------------|
| çˆ†ç‚¸ | åƒé£Ÿç‰©æ—¶       | 10-20    | å‘å¤–æ‰©æ•£ï¼Œé¢œè‰²åŒ¹é…é£Ÿç‰© |
| è½¨è¿¹ | è›‡ç§»åŠ¨æ—¶       | æŒç»­ç”Ÿæˆ | ä»å°¾éƒ¨æ·¡å‡º             |
| æ¶ˆæ•£ | æ¸¸æˆç»“æŸæ—¶     | 50+      | è›‡èº«å˜æˆç²’å­å››æ•£       |
| é—ªçƒ | é‡‘è‰²é£Ÿç‰©å­˜åœ¨æ—¶ | ç¯ç»•     | æç¤ºç©å®¶é™æ—¶           |

#### å¹³æ»‘åŠ¨ç”»
- **è›‡å¤´æ—‹è½¬**ï¼šæ ¹æ®ç§»åŠ¨æ–¹å‘æ—‹è½¬ 90Â°
- **èº«ä½“è¿æ¥**ï¼šä½¿ç”¨è´å¡å°”æ›²çº¿ç»˜åˆ¶å¹³æ»‘èº«ä½“
- **é£Ÿç‰©æµ®åŠ¨**ï¼šæ­£å¼¦æ³¢ä¸Šä¸‹æµ®åŠ¨ + ç¼©æ”¾è„‰å†²

#### å±å¹•ç‰¹æ•ˆ
- **éœ‡åŠ¨**ï¼šç¢°æ’æ—¶å±å¹•è½»å¾®éœ‡åŠ¨
- **é—ªçƒ**ï¼šå—åˆ°ä¼¤å®³æ—¶çº¢å±é—ªçƒ
- **æ…¢åŠ¨ä½œ**ï¼šåƒåˆ°ç‰¹æ®Šé“å…·æ—¶æ—¶é—´å‡é€Ÿ

### æ ¸å¿ƒæŠ€æœ¯

#### å¯¹è±¡æ± æ¨¡å¼
```cpp
class ParticlePool {
    static constexpr size_t MAX_PARTICLES = 500;
    std::array<Particle, MAX_PARTICLES> particles;

public:
    void spawn(Vector2 pos, Color color, float speed);
    void update(float dt);
    void draw();
};
```

#### ç¼“åŠ¨å‡½æ•°
```cpp
// å¸¸ç”¨çš„ç¼“åŠ¨å‡½æ•°
float EaseOutQuad(float t) { return 1 - (1 - t) * (1 - t); }
float EaseInOutCubic(float t) {
    return t < 0.5 ? 4 * t * t * t : 1 - pow(-2 * t + 2, 3) / 2;
}
```

### ä»£ç ç»“æ„
```
v2-fx/
â”œâ”€â”€ main.cpp
â”œâ”€â”€ particle.h / particle.cpp     # ç²’å­ç³»ç»Ÿ
â”œâ”€â”€ animator.h / animator.cpp     # åŠ¨ç”»ç³»ç»Ÿ
â”œâ”€â”€ easing.h                      # ç¼“åŠ¨å‡½æ•°
â”œâ”€â”€ snake_renderer.cpp            # è›‡çš„æ¸²æŸ“ï¼ˆå«åŠ¨ç”»ï¼‰
â””â”€â”€ README.md
```

---

## ğŸµ v3-audio: éŸ³æ•ˆä¸æ•°æ®æŒä¹…åŒ–

### ç›®æ ‡
æ·»åŠ å®Œæ•´çš„å£°éŸ³ç³»ç»Ÿå’Œæ•°æ®å­˜å‚¨ï¼Œå­¦ä¹ èµ„æºç®¡ç†å’Œæ–‡ä»¶ I/Oã€‚

### æ–°å¢åŠŸèƒ½

#### éŸ³æ•ˆç³»ç»Ÿ
| äº‹ä»¶       | éŸ³æ•ˆ        | å®ç°æ–¹å¼                  |
|------------|-------------|---------------------------|
| åƒæ™®é€šé£Ÿç‰© | "pop" çŸ­éŸ³  | `LoadSound` + `PlaySound` |
| åƒé‡‘è‰²é£Ÿç‰© | å‡çº§éŸ³æ•ˆ    | éŸ³è°ƒæ›´é«˜çš„ "ding"         |
| åŠ é€Ÿ       | é£å£°        | å¾ªç¯éŸ³æ•ˆï¼Œç»“æŸæ—¶æ·¡å‡º      |
| ç¢°æ’       | "thud" ä½éŸ³ | éšæœºå˜è°ƒå¢åŠ å˜åŒ–          |
| æ¸¸æˆç»“æŸ   | æ‚²ä¼¤éŸ³ä¹    | èƒŒæ™¯éŸ³ä¹åˆ‡æ¢              |

#### é«˜åˆ†æ¦œ
- æœ¬åœ°ä¿å­˜å‰ 10 å
- æ¸¸æˆç»“æŸæ—¶è¾“å…¥ç©å®¶åå­—
- æ˜¾ç¤ºæ—¥æœŸå’Œè›‡çš„é•¿åº¦
- æ’åºåŠ¨ç”»

#### è®¾ç½®ç³»ç»Ÿ
```cpp
struct Settings {
    float masterVolume = 1.0f;
    float musicVolume = 0.7f;
    float sfxVolume = 0.8f;
    Difficulty difficulty = Difficulty::NORMAL;
    KeyBindings keys;
};
```

### æ ¸å¿ƒæŠ€æœ¯

#### JSON åºåˆ—åŒ–
ä½¿ç”¨ [nlohmann/json](https://github.com/nlohmann/json) åº“ï¼š
```cpp
// ä¿å­˜é«˜åˆ†æ¦œ
void saveHighScores(const std::vector<HighScore>& scores, const std::string& path) {
    json j;
    for (const auto& s : scores) {
        j.push_back({{"name", s.name}, {"score", s.score}});
    }
    std::ofstream file(path);
    file << j.dump(2);
}

// è¯»å–é«˜åˆ†æ¦œ
std::vector<HighScore> loadHighScores(const std::string& path) {
    std::ifstream file(path);
    json j;
    file >> j;
    // è§£æ...
}
```

#### èµ„æºç®¡ç†å™¨
```cpp
class ResourceManager {
    std::unordered_map<std::string, Sound> sounds;
    std::unordered_map<std::string, Music> music;

public:
    Sound& getSound(const std::string& name);
    void unloadAll();  // RAII æ¸…ç†
};
```

### ä»£ç ç»“æ„
```
v3-audio/
â”œâ”€â”€ main.cpp
â”œâ”€â”€ resources/                    # èµ„æºç›®å½•
â”‚   â”œâ”€â”€ sounds/
â”‚   â”‚   â”œâ”€â”€ pop.wav
â”‚   â”‚   â”œâ”€â”€ ding.wav
â”‚   â”‚   â””â”€â”€ bgm.ogg
â”‚   â””â”€â”€ fonts/
â”œâ”€â”€ resource_manager.h/cpp        # èµ„æºç®¡ç†
â”œâ”€â”€ audio_system.h/cpp            # éŸ³æ•ˆç³»ç»Ÿ
â”œâ”€â”€ highscore.h/cpp               # é«˜åˆ†æ¦œ
â”œâ”€â”€ settings.h/cpp                # è®¾ç½®ç³»ç»Ÿ
â”œâ”€â”€ data/                         # å­˜æ¡£ç›®å½•
â”‚   â”œâ”€â”€ highscores.json
â”‚   â””â”€â”€ settings.json
â””â”€â”€ README.md
```

---

## ğŸ‘¥ v4-multi: å¤šäººæ¨¡å¼ä¸å…³å¡ç¼–è¾‘å™¨

### ç›®æ ‡
å®ç°æœ¬åœ°åŒäººå¯¹æˆ˜å’Œå…³å¡ç¼–è¾‘å™¨ï¼Œå­¦ä¹ æ›´å¤æ‚çš„æ¶æ„è®¾è®¡ã€‚

### æ–°å¢åŠŸèƒ½

#### åŒäººæ¨¡å¼
- **å¯¹æˆ˜æ¨¡å¼ï¼š**
  - ç©å®¶1ï¼šWASD æ§åˆ¶ï¼Œè“è‰²è›‡
  - ç©å®¶2ï¼šæ–¹å‘é”®æ§åˆ¶ï¼Œçº¢è‰²è›‡
  - ç«äº‰æœ‰é™çš„é£Ÿç‰©
  - å¯ä»¥åŒ…å›´/é˜»æŒ¡å¯¹æ–¹
  - å…ˆè¾¾åˆ°ç›®æ ‡åˆ†æ•°æˆ–æœ€åå­˜æ´»è€…è·èƒœ

- **åˆä½œæ¨¡å¼ï¼š**
  - å…±åŒæ§åˆ¶ä¸€æ¡è¶…é•¿çš„è›‡
  - ç©å®¶1æ§åˆ¶å‰åŠæ®µï¼Œç©å®¶2æ§åˆ¶ååŠæ®µ
  - éœ€è¦åè°ƒé…åˆ

#### å…³å¡ç¼–è¾‘å™¨
- **å¯è§†åŒ–ç¼–è¾‘ï¼š**
  - é¼ æ ‡ç‚¹å‡»æ”¾ç½®/åˆ é™¤å¢™å£
  - é¢„è®¾é£Ÿç‰©ä½ç½®
  - è®¾ç½®å‡ºç”Ÿç‚¹

- **æ–‡ä»¶æ ¼å¼ï¼š**
```json
{
  "name": "è¿·å®«æŒ‘æˆ˜",
  "author": "Player1",
  "width": 40,
  "height": 30,
  "walls": [[1,1], [1,2], ...],
  "spawn_points": [[20,15], [10,10]],
  "target_score": 100
}
```

#### AI å¯¹æ‰‹
- **ç®€å• AIï¼š** éšæœºç§»åŠ¨ï¼Œé¿å¼€å¢™å£
- **æ™®é€š AIï¼š** æœé£Ÿç‰©æ–¹å‘ç§»åŠ¨
- **å›°éš¾ AIï¼š** BFS å¯»è·¯ + é™·é˜±è®¾ç½®

### æ ¸å¿ƒæŠ€æœ¯

#### BFS è·¯å¾„å¯»æ‰¾
```cpp
std::vector<Direction> findPath(GridPos start, GridPos target) {
    std::queue<GridPos> queue;
    std::unordered_map<GridPos, GridPos> cameFrom;

    queue.push(start);
    cameFrom[start] = start;

    while (!queue.empty()) {
        auto current = queue.front();
        queue.pop();

        if (current == target) break;

        for (auto dir : {UP, DOWN, LEFT, RIGHT}) {
            auto next = current + dir;
            if (isValid(next) && !cameFrom.count(next)) {
                queue.push(next);
                cameFrom[next] = current;
            }
        }
    }
    // é‡å»ºè·¯å¾„...
}
```

#### ECS æ¶æ„ï¼ˆç®€åŒ–ç‰ˆï¼‰
```cpp
// å®ä½“åªæ˜¯ä¸€ä¸ª ID
using Entity = uint32_t;

// ç»„ä»¶æ˜¯çº¯æ•°æ®
struct Position { float x, y; };
struct Velocity { float dx, dy; };
struct Sprite { Texture2D texture; };

// ç³»ç»Ÿå¤„ç†é€»è¾‘
class MovementSystem : public System {
public:
    void update(float dt) {
        for (auto [pos, vel] : query<Position, Velocity>()) {
            pos.x += vel.dx * dt;
            pos.y += vel.dy * dt;
        }
    }
};
```

### ä»£ç ç»“æ„
```
v4-multi/
â”œâ”€â”€ main.cpp
â”œâ”€â”€ core/
â”‚   â”œâ”€â”€ ecs.h/cpp              # ECS æ¡†æ¶
â”‚   â”œâ”€â”€ game_state.h/cpp       # çŠ¶æ€æœº
â”‚   â””â”€â”€ event_system.h/cpp     # äº‹ä»¶ç³»ç»Ÿ
â”œâ”€â”€ game/
â”‚   â”œâ”€â”€ snake.h/cpp            # è›‡å®ä½“
â”‚   â”œâ”€â”€ player.h/cpp           # ç©å®¶ç»„ä»¶
â”‚   â””â”€â”€ ai_controller.h/cpp    # AI æ§åˆ¶å™¨
â”œâ”€â”€ editor/
â”‚   â”œâ”€â”€ level_editor.h/cpp     # ç¼–è¾‘å™¨
â”‚   â””â”€â”€ level_loader.h/cpp     # å…³å¡åŠ è½½å™¨
â”œâ”€â”€ multiplayer/
â”‚   â”œâ”€â”€ game_mode.h/cpp        # æ¸¸æˆæ¨¡å¼åŸºç±»
â”‚   â”œâ”€â”€ versus_mode.h/cpp      # å¯¹æˆ˜æ¨¡å¼
â”‚   â””â”€â”€ co-op_mode.h/cpp       # åˆä½œæ¨¡å¼
â”œâ”€â”€ resources/
â”œâ”€â”€ levels/                    # è‡ªå®šä¹‰å…³å¡
â””â”€â”€ README.md
```

---

## ğŸ“š å­¦ä¹ è·¯å¾„å»ºè®®

### åˆå­¦è€…è·¯çº¿
1. å®Œæˆ `chapters/01-04` åŸºç¡€çŸ¥è¯†
2. é˜…è¯» `v0-base` ä»£ç ï¼Œç†è§£æ•´ä½“ç»“æ„
3. å°è¯•ä¿®æ”¹å‚æ•°ï¼ˆé€Ÿåº¦ã€ç½‘æ ¼å¤§å°ï¼‰
4. è·Ÿç€æ–‡æ¡£å®ç° `v1-items`

### è¿›é˜¶è·¯çº¿
1. å¿«é€Ÿæµè§ˆ `v0` å’Œ `v1`
2. é‡ç‚¹ç ”ç©¶ `v2-fx` çš„ç²’å­ç³»ç»Ÿ
3. å®ç° `v3-audio` çš„ JSON å­˜å‚¨
4. æŒ‘æˆ˜ `v4-multi` çš„ AI æˆ–ç¼–è¾‘å™¨

### é¡¹ç›®å®è·µ
- ä¸ºæŸä¸ªç‰ˆæœ¬æ·»åŠ æ–°åŠŸèƒ½
- é‡æ„ä»£ç ä½¿ç”¨è®¾è®¡æ¨¡å¼
- å°†æ¸¸æˆç§»æ¤åˆ° Web (Emscripten)
- æ·»åŠ ç½‘ç»œå¤šäººå¯¹æˆ˜

---

## ğŸ”— ç›¸å…³èµ„æº

- [Raylib éŸ³é¢‘æ–‡æ¡£](https://www.raylib.com/cheatsheet/cheatsheet.html)
- [nlohmann/json æ•™ç¨‹](https://json.nlohmann.me/)
- [æ¸¸æˆè®¾è®¡æ¨¡å¼](https://gameprogrammingpatterns.com/)
- [BFS ç®—æ³•å¯è§†åŒ–](https://visualgo.net/en/dfsbfs)

---

## ğŸ“ è´¡çŒ®æŒ‡å—

æ¬¢è¿æäº¤ PR å®Œå–„å„ä¸ªç‰ˆæœ¬ï¼š
1. ä¿®å¤ bug æˆ–æ”¹è¿›ä»£ç è´¨é‡
2. æ·»åŠ æ›´å¤šæ³¨é‡Šå’Œæ–‡æ¡£
3. å®ç°ç¼ºå¤±çš„åŠŸèƒ½
4. åˆ›å»ºæ–°çš„æ¸¸æˆå˜ä½“
